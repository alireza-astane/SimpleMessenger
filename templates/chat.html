<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Chat with {{ other_user_name }}</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        display: flex;
        flex-direction: column;
        height: 100vh;
      }
      .chat-header {
        background: #eee;
        padding: 1rem;
        text-align: center;
      }
      .chat-messages {
        flex: 1;
        overflow-y: auto;
        padding: 1rem;
        border-top: 1px solid #ccc;
        border-bottom: 1px solid #ccc;
      }
      .message {
        margin-bottom: 1rem;
      }
      .message .meta {
        font-size: 0.9em;
        color: #555;
      }
      .chat-input {
        display: flex;
        padding: 1rem;
        border-top: 1px solid #ccc;
      }
      .chat-input input[type="text"] {
        flex: 1;
        padding: 0.5rem;
      }
      .chat-input button {
        padding: 0.5rem 1rem;
        margin-left: 0.5rem;
      }
      .back-button {
        margin: 1rem;
      }
    </style>
  </head>
  <body>
    <div class="back-button">
      <form action="/chats" method="get">
        <button type="submit">Back to Chats</button>
      </form>
    </div>
    <div class="chat-header">
      <h2>Chat with {{ other_user_name }}</h2>
    </div>
    <div class="chat-messages">
      {% if messages %}
        {% for msg in messages %}
          <div class="message">
            <div class="meta">
              <strong>{{ msg.sender }}</strong> at {{ msg.sent_datetime }}
            </div>
            <div class="text">
              {{ msg.text }}
            </div>
          </div>
        {% endfor %}
      {% else %}
        <p>No messages yet.</p>
      {% endif %}
    </div>
    <div class="chat-input">
      <form action="/chat/{{ chat_id }}/message" method="post" style="width: 100%; display: flex;">
        <input type="text" name="message" placeholder="Type your message here" required />
        <button type="submit">Send</button>
      </form>
    </div>
  </body>
</html>